# NumPy

### 创建ndarray
```python
import numpy as np
data1 = [6,7.5,8,0,1]
arr1 = np.array(data1)
arr1
```
\>>>array([6. , 7.5, 8. , 0. , 1. ])


### 嵌套序列转换成多维数组
```python
data2 = [[1,2,3,4],[5,6,7,8]]
arr2 = np.array(data2)
arr2
>>>
array([[1, 2, 3, 4],
       [5, 6, 7, 8]])

arr2.ndim
>>>2

arr2.shape
>>>(2, 4)
```

### dtype
```python
arr1.dtype
>>>dtype('float64')

arr2.dtype
>>>dtype('int64')
```

### zeros/ones/empty
```python
np.zeros(10)
>>>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])

np.zeros((3,6))
>>>array([[0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0.]])

np.empty((2,3,3)) # 没有任何具体值的数组
>>>
array([[[0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.]]])
```

### arange对应python内置的range
```python
np.arange(15)
array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14])
```

### ndarray的数据类型
- dtype是NumPy强大和灵活的原因之一

```python
arr1 = np.array([1,2,3],dtype=np.float64)
arr2 = np.array([1,2,3],dtype=np.int32)
arr1.dtype
>>>dtype('float64')
arr2.dtype
>>>dtype('int32')
```

### astype
```python
arr = np.array([1,2,3,4,5])
arr.dtype
>>>dtype('int64')

float_arr = arr.astype(np.float64)
float_arr.dtype
>>>dtype('float64')
```
```python
arr = np.array([3.7,-1.2,3.2])
arr
>>>array([ 3.7, -1.2,  3.2])

arr.astype(np.int32)
>>>array([ 3, -1,  3], dtype=int32)
```
```python
numeric_strings = np.array(['1.2','34.32','1.34'],dtype=np.string_)
numeric_strings.astype(float)
>>>array([ 1.2 , 34.32,  1.34])
```
```python
int_array = np.arange(10)
calibers = np.array([.22,.240,.234,.33,.23],dtype=np.float64)
int_array.astype(calibers.dtype)
>>>array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])
```
```python
empty_unit32 = np.empty(8,dtype='u4')
empty_unit32
>>>array([         0, 1075314688,          0, 1075707904,          0,
       1075838976,          0, 1072693248], dtype=uint32)
```

### 数组和标量之间的运算
```python
arr = np.array([[1.,2.,3.],[4.,5.,6.]])
arr
>>>array([[1., 2., 3.],
       [4., 5., 6.]])

arr*arr
>>>array([[ 1.,  4.,  9.],
       [16., 25., 36.]])

arr-arr
array([[0., 0., 0.],
       [0., 0., 0.]])
```

### 基本的索引和切片
```python
arr = np.arange(10)
arr[5]
>>>5

arr[5:8]
>>>array([5, 6, 7])

arr[5:8] = 12
arr
>>>array([ 0,  1,  2,  3,  4, 12, 12, 12,  8,  9])
```
```python
arr_slice = arr[5:8]
arr_slice[1]=12345
arr
>>>array([    0,     1,     2,     3,     4,    12, 12345,    12,     8,
           9])
arr_slice[:] = 64
arr
>>>array([ 0,  1,  2,  3,  4, 64, 64, 64,  8,  9])
```
```python
arr2d = np.array([[1,2,3],[4,5,6],[7,8,9]])
arr2d[2]
>>>array([7, 8, 9])

arr2d[0][2]
>>>3

arr2d[0,2]
>>>3
```
```python
arr3d = np.array([[[1,2,3],[4,5,6]],[[7,8,9],[10,11,12]]])
arr3d
>>> array([[[ 1,  2,  3],
        [ 4,  5,  6]],

       [[ 7,  8,  9],
        [10, 11, 12]]])
arr3d[0]
>>>array([[1, 2, 3],
       [4, 5, 6]])
```
```python
old_values = arr3d[0].copy()
arr3d[0] = 42
arr3d
>>>array([[[42, 42, 42],
        [42, 42, 42]],

       [[ 7,  8,  9],
        [10, 11, 12]]])

arr3d[0] = old_values
arr3d
>>>array([[[ 1,  2,  3],
        [ 4,  5,  6]],

       [[ 7,  8,  9],
        [10, 11, 12]]])

arr3d[1,0]
>>>array([7, 8, 9])
```

### 切片索引
```python
arr[1:6]
>>>array([7, 8, 9])

arr2d
>>>array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])

arr2d[:2]
>>>array([[1, 2, 3],
       [4, 5, 6]])

arr2d[:2,1:]
>>>array([[2, 3],
       [5, 6]])

arr2d[1,:2]
>>>array([4, 5])

arr2d[:,:1]
>>>array([[1],
       [4],
       [7]])
```

### 布尔型索引
```python
names = np.array(['Bob','Joe','Will','Bob','Will','Joe','Joe'])
data = np.random.randn(7,4)
names
>>>array(['Bob', 'Joe', 'Will', 'Bob', 'Will', 'Joe', 'Joe'], dtype='<U4')

data
>>>array([[-0.54093662,  0.98533044,  0.82009084,  1.20798381],
       [ 1.82829901,  0.17411663, -1.51303825,  0.22804367],
       [-0.65078152,  0.08313449,  0.83880963, -1.78276309],
       [ 0.61207065,  1.15364584, -0.12602078, -1.09535793],
       [ 0.45050638,  1.58353401, -0.46624268, -0.25089213],
       [-0.14677405,  0.26151823,  1.13177225, -1.47578361],
       [-0.80152908,  0.49052361,  0.22747227, -0.7811803 ]])

names == 'Bob'
>>>array([ True, False, False,  True, False, False, False])

data[names == 'Bob']
>>>array([[-0.54093662,  0.98533044,  0.82009084,  1.20798381],
       [ 0.61207065,  1.15364584, -0.12602078, -1.09535793]])

data[names == 'Bob',2:]
>>>array([[ 0.82009084,  1.20798381],
       [-0.12602078, -1.09535793]])
```

```python
names != 'Bob'
>>>array([False,  True,  True, False,  True,  True,  True])

data[~(names=='Bob')]
>>>array([[ 1.82829901,  0.17411663, -1.51303825,  0.22804367],
       [-0.65078152,  0.08313449,  0.83880963, -1.78276309],
       [ 0.45050638,  1.58353401, -0.46624268, -0.25089213],
       [-0.14677405,  0.26151823,  1.13177225, -1.47578361],
       [-0.80152908,  0.49052361,  0.22747227, -0.7811803 ]])

mask = (names == 'Bob') | (names == 'Will')
mask
>>>array([ True, False,  True,  True,  True, False, False])

data[mask]
array([[-0.54093662,  0.98533044,  0.82009084,  1.20798381],
       [-0.65078152,  0.08313449,  0.83880963, -1.78276309],
       [ 0.61207065,  1.15364584, -0.12602078, -1.09535793],
       [ 0.45050638,  1.58353401, -0.46624268, -0.25089213]])

data[data<0] = 0
data
>>>array([[0.        , 0.98533044, 0.82009084, 1.20798381],
       [1.82829901, 0.17411663, 0.        , 0.22804367],
       [0.        , 0.08313449, 0.83880963, 0.        ],
       [0.61207065, 1.15364584, 0.        , 0.        ],
       [0.45050638, 1.58353401, 0.        , 0.        ],
       [0.        , 0.26151823, 1.13177225, 0.        ],
       [0.        , 0.49052361, 0.22747227, 0.        ]])

data[names != 'Joe'] = 7
data
>>>array([[7.        , 7.        , 7.        , 7.        ],
       [1.82829901, 0.17411663, 0.        , 0.22804367],
       [7.        , 7.        , 7.        , 7.        ],
       [7.        , 7.        , 7.        , 7.        ],
       [7.        , 7.        , 7.        , 7.        ],
       [0.        , 0.26151823, 1.13177225, 0.        ],
       [0.        , 0.49052361, 0.22747227, 0.        ]])
```
