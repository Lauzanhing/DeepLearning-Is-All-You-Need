### 花式索引
```python
import numpy as np

arr = np.empty((8,4))
for i in range(8):
    arr[i] = i
arr
>>>array([[0., 0., 0., 0.],
       [1., 1., 1., 1.],
       [2., 2., 2., 2.],
       [3., 3., 3., 3.],
       [4., 4., 4., 4.],
       [5., 5., 5., 5.],
       [6., 6., 6., 6.],
       [7., 7., 7., 7.]])

arr[[4,3,0,6]]
>>>array([[4., 4., 4., 4.],
       [3., 3., 3., 3.],
       [0., 0., 0., 0.],
       [6., 6., 6., 6.]])

arr[[-3,-5,-7]]
>>>array([[5., 5., 5., 5.],
       [3., 3., 3., 3.],
       [1., 1., 1., 1.]])
```

```python
arr = np.arange(32).reshape((8,4))
arr
>>>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [12, 13, 14, 15],
       [16, 17, 18, 19],
       [20, 21, 22, 23],
       [24, 25, 26, 27],
       [28, 29, 30, 31]])

arr[[1,5,7,2],[0,3,1,2]]
>>>array([ 4, 23, 29, 10])

arr[[1,5,7,2],[0,3,1,2]]
>>>array([ 4, 23, 29, 10])

arr[[1,5,7,2]][:,[0,3,1,2]]
>>>array([[ 4,  7,  5,  6],
       [20, 23, 21, 22],
       [28, 31, 29, 30],
       [ 8, 11,  9, 10]])

arr[np.ix_([1,5,7,2],[0,3,1,2])]
>>>array([[ 4,  7,  5,  6],
       [20, 23, 21, 22],
       [28, 31, 29, 30],
       [ 8, 11,  9, 10]])
```

### 数组转置和轴对换
```python
import numpy as np
arr = np.arange(15).reshape((3,5))
arr
>>>array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14]])

arr.T
>>>array([[ 0,  5, 10],
       [ 1,  6, 11],
       [ 2,  7, 12],
       [ 3,  8, 13],
       [ 4,  9, 14]])
```

```python
arr = np.random.randn(6,3)
np.dot(arr.T,arr)
>>>array([[ 8.02959867, -3.01630352, -0.41965466],
       [-3.01630352,  2.5214298 , -0.46033103],
       [-0.41965466, -0.46033103, 10.16008764]])
```
```python
arr = np.arange(16).reshape((2,2,4))
arr
>>>array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7]],

       [[ 8,  9, 10, 11],
        [12, 13, 14, 15]]])

arr.transpose((1,0,2))
>>>array([[[ 0,  1,  2,  3],
        [ 8,  9, 10, 11]],

       [[ 4,  5,  6,  7],
        [12, 13, 14, 15]]])

arr
>>>array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7]],

       [[ 8,  9, 10, 11],
        [12, 13, 14, 15]]])

arr.swapaxes(1,2)
>>>array([[[ 0,  4],
        [ 1,  5],
        [ 2,  6],
        [ 3,  7]],

       [[ 8, 12],
        [ 9, 13],
        [10, 14],
        [11, 15]]])

# arr.transpose(0,2,1)
```

### 快速的元素级数组函数
```python
arr = np.arange(10)
np.sqrt(arr)
>>>array([0.        , 1.        , 1.41421356, 1.73205081, 2.        ,
       2.23606798, 2.44948974, 2.64575131, 2.82842712, 3.        ])

np.exp(arr)
>>>array([1.00000000e+00, 2.71828183e+00, 7.38905610e+00, 2.00855369e+01,
       5.45981500e+01, 1.48413159e+02, 4.03428793e+02, 1.09663316e+03,
       2.98095799e+03, 8.10308393e+03])
```

```python
x = np.random.randn(8)
y = np.random.randn(8)
x
>>>array([-0.04595981, -2.15861556, -0.08358151, -1.48131722, -0.37872425,
       -1.48837647, -0.22262516, -0.12835625])

y
>>>array([ 0.9594706 , -1.0880696 ,  0.8008791 ,  2.0004324 , -0.27211227,
       -1.11686688,  0.32534689,  0.6895263 ])

np.maximum(x,y)
>>>array([ 0.9594706 , -1.0880696 ,  0.8008791 ,  2.0004324 , -0.27211227,
       -1.11686688,  0.32534689,  0.6895263 ])

arr = np.random.randn(7) * 5
np.modf(arr) # 小数和整数部分分开独立返回
>>>(array([ 0.02224907, -0.20253028,  0.02301522, -0.9997869 , -0.41497456,
         0.67363257,  0.38851297]), array([ 4., -7.,  1., -0., -1.,  5.,  5.]))
```

### 利用数组进行数据处理
```python
import numpy as np
points = np.arange(-5,5,0.01) # 1000个间隔相等的点
xs,ys = np.meshgrid(points,points)
ys
>>>array([[-5.  , -5.  , -5.  , ..., -5.  , -5.  , -5.  ],
       [-4.99, -4.99, -4.99, ..., -4.99, -4.99, -4.99],
       [-4.98, -4.98, -4.98, ..., -4.98, -4.98, -4.98],
       ...,
       [ 4.97,  4.97,  4.97, ...,  4.97,  4.97,  4.97],
       [ 4.98,  4.98,  4.98, ...,  4.98,  4.98,  4.98],
       [ 4.99,  4.99,  4.99, ...,  4.99,  4.99,  4.99]])

import matplotlib.pyplot as plt
z = np.sqrt(xs ** 2 + ys ** 2)
z
>>>array([[7.07106781, 7.06400028, 7.05693985, ..., 7.04988652, 7.05693985,
        7.06400028],
       [7.06400028, 7.05692568, 7.04985815, ..., 7.04279774, 7.04985815,
        7.05692568],
       [7.05693985, 7.04985815, 7.04278354, ..., 7.03571603, 7.04278354,
        7.04985815],
       ...,
       [7.04988652, 7.04279774, 7.03571603, ..., 7.0286414 , 7.03571603,
        7.04279774],
       [7.05693985, 7.04985815, 7.04278354, ..., 7.03571603, 7.04278354,
        7.04985815],
       [7.06400028, 7.05692568, 7.04985815, ..., 7.04279774, 7.04985815,
        7.05692568]])
# %%
plt.imshow(z,cmap=plt.cm.gray)
plt.colorbar()
# %%
```

### 将条件逻辑表述为数组运算
- numpy.where函数是三元表达式x if condition else y的矢量化版本
```python
xarr = np.array([1.1,1.2,1.3,1.4,1.5])
yarr = np.array([2.1,2.2,2.3,2.4,2.5])
cond = np.array([True,False,True,True,False])
result = [(x if c else y) for x,y,c in zip(xarr,yarr,cond)]
result
>>>[1.1, 2.2, 1.3, 1.4, 2.5]

result = np.where(cond,xarr,yarr)
result
>>>array([1.1, 2.2, 1.3, 1.4, 2.5])
```
```python
arr = np.random.randn(4,4)
arr
>>>array([[-0.97191715,  0.34417757,  0.77529307, -0.65098348],
       [-1.32488361,  0.1066985 , -0.61540483, -0.58295264],
       [-2.44526354,  1.00357494,  0.23797779, -1.73224649],
       [-0.34215509, -1.07049879, -0.28219591, -0.3031155 ]])

np.where(arr>0,2,-2) #2 if >0 else -2
>>>array([[-2,  2,  2, -2],
       [-2,  2, -2, -2],
       [-2,  2,  2, -2],
       [-2, -2, -2, -2]])

np.where(arr > 0,2,arr)
>>>array([[-0.97191715,  2.        ,  2.        , -0.65098348],
       [-1.32488361,  2.        , -0.61540483, -0.58295264],
       [-2.44526354,  2.        ,  2.        , -1.73224649],
       [-0.34215509, -1.07049879, -0.28219591, -0.3031155 ]])
```

```python
result = []
for i in range(n):
    result.append(0)
elif cond1[i] and cond2[i]:
    result.append(1)
elif cond2[i]:
    result.append(2)
else:
    result.append(3)

np.where(cond1 & cond2,0,np.where(cond1,1,np.where(cond2,2,3)))
```

### 数学和统计方法
```python
arr = np.random.randn(5,4) # 正态分布的数据
arr.mean()
>>>-0.08429328344159606

np.mean(arr)
>>>-0.08429328344159606

arr.sum()
>>>-1.6858656688319213

arr.mean(axis=1)
>>>array([-0.51894274, -0.0234353 , -0.89300257,  0.34560603,  0.66830816])

arr.sum(0)
>>>array([-2.6684326 ,  2.88438813, -2.50622243,  0.60440123])

arr = np.array([[0,1,2],[3,4,5],[6,7,8]])
arr.cumsum(0)
>>>array([[ 0,  1,  2],
       [ 3,  5,  7],
       [ 9, 12, 15]])

arr.cumsum(0)
>>>array([[ 0,  1,  2],
       [ 3,  5,  7],
       [ 9, 12, 15]])

arr.cumprod(1)
>>>array([[  0,   0,   0],
       [  3,  12,  60],
       [  6,  42, 336]])
```

### 用于布尔型数组的方法
```python
import numpy as np
arr = np.random.randn(100)
(arr > 0).sum()#有多少正值
>>>52

bools = np.array([False,False,True,False])
bools.any() # 检测是否存在True
>>>True

bools.all()
>>>False
```
